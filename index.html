<!-- Athens Social Hub - Single File Alpha Demo -->
<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Athens Social Hub</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    :root {
      --bg-body: #ccd2e5;
      --bg-frame: #020617;
      --bg-header: #020617;
      --bg-card: #ffffff;
      --text-main: #0f172a;
      --text-muted: #6b7280;
      --accent: #2563eb;
      --accent-soft: #dbeafe;
      --border-soft: #e5e7eb;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 16px;
      background: #000000;      /* ŒúŒ±œçœÅŒø Œ≠Œæœâ Œ±œÄœå œÑŒø Œ∫ŒπŒΩŒ∑œÑœå */
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .phone-frame {
      width: 390px;
      max-width: 100%;
      height: 720px;
      background: #ccd2e5 !important;  /* ŒßœÅœéŒºŒ± Œ∫ŒπŒΩŒ∑œÑŒøœç */
      border-radius: 32px;
      box-shadow: 0 18px 40px rgba(15,23,42,0.45);
      color: #e5e7eb;
      position: relative;
      overflow: hidden;
    }

    .phone-notch {
      width: 120px;
      height: 24px;
      background: #020617;
      border-radius: 0 0 16px 16px;
      margin: 0 auto;
      margin-top: 6px;
    }

    .app-header {
      padding: 6px 12px 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--bg-header);
    }

    .header-logo-box {
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }

    .header-logo {
      width: 150px;
      height: auto;
      display: block;
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: #111827;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      cursor: pointer;
      border: 1px solid rgba(148,163,184,0.6);
      position: relative;
      z-index: 5;
    }

    main#screen-container {
      position: absolute;
      top: 90px;
      bottom: 60px;
      left: 0;
      right: 0;
      overflow-y: auto;
    }

    .screen {
      width: 100%;
      height: 100%;
      overflow-y: auto;
    }

    .card {
      background: var(--bg-card);
      color: var(--text-main);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: 0 10px 25px rgba(15,23,42,0.22);
      border: 1px solid var(--border-soft);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 4px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-main);
    }

    .card-subtitle {
      font-size: 11px;
      color: var(--text-muted);
    }

    .home-tile {
      background: #f9fafb;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 6px 16px rgba(15,23,42,0.15);
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease;
      color: #000000 !important;      /* ŒúŒëŒ•Œ°Œü Œ∫ŒµŒØŒºŒµŒΩŒø */
      font-weight: 600;
    }
    .home-tile:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 24px rgba(15,23,42,0.25);
    }

    .bottom-nav {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: #020617;
      border-top: 1px solid rgba(15,23,42,0.9);
      display: flex;
      align-items: center;
      justify-content: space-around;
      padding: 4px 8px 6px;
    }

    .nav-btn {
      flex: 1;
      background: transparent;
      border: none;
      color: #9ca3af;
      font-size: 11px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      cursor: pointer;
    }
    .nav-btn span:first-child { font-size: 16px; }
    .nav-btn.active { color: #e5e7eb; }
    .nav-btn.active span:first-child { transform: translateY(-1px); }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 13px;
      cursor: pointer;
    }
    .btn-full { width: 100%; text-align: center; }
    .btn-primary {
      background: var(--accent);
      color: #eff6ff;
      border: 1px solid #1d4ed8;
      box-shadow: 0 10px 20px rgba(37,99,235,0.35);
    }
    .btn-outline {
      background: #f9fafb;
      color: var(--text-main);
      border: 1px solid #d1d5db;
    }
    .btn-small {
      padding: 4px 10px;
      font-size: 11px;
    }

    .input {
      width: 100%;
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      outline: none;
    }
    .input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .note {
      font-size: 11px;
      color: var(--text-muted);
    }

    .tag {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
    }
    .tag-green {
      background: #dcfce7;
      color: #166534;
    }

    /* Leaflet container */
    #mapContainer { width: 100%; height: 100%; }
    .leaflet-container {
      background: #020617;
      border-radius: 0;
    }

    /* Map dots */
    .trafficDot,
    .cleaningDot,
    .eventDot,
    .garbageDot,
    .volunteerDot,
    .reportDot,
    .offerDot {
      border-radius: 999px;
      box-shadow: 0 0 0 2px rgba(15,23,42,0.7);
    }
    .trafficDot {
      width: 10px; height: 10px;
      background: #ef4444;
      border: 2px solid #fee2e2;
    }
    .cleaningDot {
      width: 10px; height: 10px;
      background: #22c55e;
      border: 2px solid #bbf7d0;
    }
    .eventDot {
      width: 10px; height: 10px;
      background: #3b82f6;
      border: 2px solid #bfdbfe;
    }
    .garbageDot {
      width: 12px; height: 12px;
      background: #facc15;
      border: 2px solid #fef9c3;
    }
    .volunteerDot {
      width: 12px; height: 12px;
      background: #a855f7;
      border: 2px solid #e9d5ff;
    }
    .reportDot {
      width: 10px; height: 10px;
      background: #f97316;
      border: 2px solid #ffedd5;
    }
    .offerDot {
      width: 10px; height: 10px;
      background: #0ea5e9;
      border: 2px solid #bae6fd;
    }

    /* Athens tabs */
    .da-tab {
      border: none;
      background: transparent;
      color: #9ca3af;
      padding: 6px 10px;
      border-radius: 999px;
      white-space: nowrap;
      font-size: 11px;
      cursor: pointer;
    }
    .da-tab.active {
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      box-shadow: 0 0 0 1px rgba(148,163,184,0.5);
    }

    /* Honour badge */
    .honour-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #fef3c7;
      color: #92400e;
      font-size: 11px;
      font-weight: 600;
    }

    /* Volunteer enable switch */
    .switch-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .switch-label {
      font-size: 13px;
      color: var(--text-main);
    }
    .switch {
      position: relative;
      width: 44px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      inset: 0;
      background-color: #d1d5db;
      border-radius: 99px;
      transition: .2s;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      border-radius: 50%;
      transition: .2s;
    }
    .switch input:checked + .slider {
      background-color: #22c55e;
    }
    .switch input:checked + .slider:before {
      transform: translateX(18px);
    }

  </style>
</head>
<body>
  <div class="phone-frame">
    <div class="phone-notch"></div>

    <header class="app-header">
      <div class="header-logo-box">
        <!-- ŒíŒ¨ŒªŒµ œÑŒø logo œÉŒøœÖ ŒµŒ¥œé -->
        <img src="img/athenshub-logo.png" class="header-logo" alt="Athens Social Hub Logo">
      </div>
      <div class="user-avatar" id="avatarBtn">üë§</div>
    </header>

    <main id="screen-container">
      <!-- HOME -->
      <section class="screen" id="screen-home" style="display:block; padding:14px;">
        <div class="card" id="dailyAthensCard">
          <div class="card-header">
            <div class="card-title">Daily Athens</div>
          </div>
          <div style="font-size:11px; color:var(--text-muted); line-height:1.4;">
            ‚Ä¢ New art exhibition opens today in Gazi.<br/>
            ‚Ä¢ City cleaning upgrades announced for 2025.<br/>
            ‚Ä¢ Weekend event: Open-air cinema in Thisio.<br/>
            ‚Ä¢ Traffic update: Light delays near Syntagma.<br/>
          </div>
        </div>

        <div id="userInfoBox" style="margin-top:10px; margin-bottom:14px; display:none;">
          <div class="card">
            <h2 id="userName" style="font-size:16px; margin-bottom:4px;"></h2>
            <div id="userRole" style="font-size:12px; color:var(--text-muted);"></div>
          </div>
        </div>

        <div id="homeMenu"></div>
      </section>

      <!-- STATUS -->
      <section class="screen" id="screen-status" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Your Status</div>
              <div class="card-subtitle">AI-prioritized updates for you</div>
            </div>
          </div>
        </div>
        <div id="statusContent"></div>
      </section>

      <!-- DAILY ATHENS -->
      <section class="screen" id="screen-athens" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Daily Athens</div>
              <div class="card-subtitle">Personalized city feed for your role</div>
            </div>
            <button id="daAIButton" class="btn btn-outline btn-small" type="button">
              üîç Use AI Filtering
            </button>
          </div>
        </div>

        <div class="card" style="padding:8px 10px; margin-bottom:10px;">
          <div id="daTabs" style="display:flex; gap:6px; overflow-x:auto; font-size:11px; padding-bottom:4px;">
            <button class="da-tab active" data-cat="highlights">‚≠ê Highlights</button>
            <button class="da-tab" data-cat="news">üóû News</button>
            <button class="da-tab" data-cat="culture">üé≠ Culture</button>
            <button class="da-tab" data-cat="city">üöß City Updates</button>
            <button class="da-tab" data-cat="mobility">üö¶ Mobility</button>
            <button class="da-tab" data-cat="neighborhood">üèò Neighborhood</button>
          </div>
        </div>

        <div id="daCards"></div>
      </section>

      <!-- FRIENDLY WALK -->
      <section class="screen" id="screen-friendly" style="display:none; padding:14px;">
        <h2 style="margin-bottom:10px;">Friendly Walk</h2>

        <div id="fwLocation" class="card" style="margin-bottom:12px;">
          <strong>üìç Finding your location‚Ä¶</strong>
        </div>

        <div class="card" style="margin-bottom:12px;">
          <label style="font-size:12px; color:var(--text-muted);">What would you like to explore?</label>
          <div style="display:flex; gap:8px; margin-top:6px;">
            <input id="fwQuery" type="text"
                   placeholder="e.g. Museums, Food, Photography‚Ä¶"
                   style="flex:1; padding:8px; border-radius:8px; border:1px solid #ddd;">
            <button id="fwMic" class="btn btn-outline" style="padding:8px;">üé§</button>
          </div>
        </div>

        <div id="fwResults"></div>

        <button class="btn btn-primary btn-full" style="margin-top:20px;" id="fwPickMap">
          üìå Pick on Map
        </button>
      </section>

      <!-- VOLUNTEER ENABLE STATUS -->
      <section class="screen" id="screen-volstatus" style="display:none; padding:14px;">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Volunteer Status</div>
              <div class="card-subtitle">Control if you are visible to visitors</div>
            </div>
          </div>
          <div style="margin-top:8px; font-size:13px;">
            <div class="switch-row">
              <div class="switch-label">
                Enable Friendly Walk availability
              </div>
              <label class="switch">
                <input type="checkbox" id="volSwitch">
                <span class="slider"></span>
              </label>
            </div>
            <p id="volStatusText" class="note" style="margin-top:8px;">
              You are currently <strong>offline</strong> as volunteer.
            </p>
          </div>
        </div>
      </section>

      <!-- REPORT A PROBLEM -->
      <section class="screen" id="screen-report" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:14px;">
          <div class="card-header">
            <div class="card-title">Report a Problem</div>
            <div class="card-subtitle">Help improve Athens by reporting issues</div>
          </div>
        </div>

        <div class="card" style="padding:12px; margin-bottom:14px;">
          <h3 style="font-size:13px; margin-bottom:10px;">Location</h3>
          <button class="btn btn-primary btn-full" onclick="useMyLocation()">
            üìç Use my current location
          </button>
          <button class="btn btn-outline btn-full" style="margin-top:8px;" onclick="pickLocationOnMap()">
            üó∫Ô∏è Pick location on map
          </button>
          <p id="reportLocationText" class="note" style="margin-top:10px;">
            No location selected yet.
          </p>
        </div>

        <div class="card" style="padding:12px; margin-bottom:14px;">
          <h3 style="font-size:13px; margin-bottom:10px;">Type of Problem</h3>
          <select id="problemType" class="input">
            <option value="">Select...</option>
          </select>
        </div>

        <div class="card" style="padding:12px; margin-bottom:14px;">
          <h3 style="font-size:13px; margin-bottom:10px;">Description</h3>
          <div style="position:relative;">
            <textarea id="problemDesc" class="input"
                      placeholder="Describe the issue..."
                      style="height:80px; padding-right:32px;"></textarea>
            <button id="micBtn" onclick="startVoiceInput()"
              style="position:absolute; right:6px; top:6px; background:none; border:none; font-size:18px; cursor:pointer;">
              üé§
            </button>
          </div>
          <button onclick="aiDetectProblem()" class="btn btn-outline btn-full" style="margin-top:10px;">
            ü§ñ Use AI to detect problem
          </button>
        </div>

        <div class="card" style="padding:12px; margin-bottom:14px;">
          <h3 style="font-size:13px; margin-bottom:10px;">Photo</h3>
          <input type="file" id="problemPhoto" accept="image/*" class="input" />
        </div>

        <button class="btn btn-primary btn-full" onclick="submitReport()">
          Submit Report
        </button>
      </section>

      <!-- ATHENS IN A CLICK -->
      <section class="screen" id="screen-aiclick" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Athens in a Click</div>
              <div class="card-subtitle">Most useful city services for you</div>
            </div>
          </div>
        </div>
        <div id="aiclickContent"></div>
      </section>

      <!-- ENJOY ATHENS -->
      <section class="screen" id="screen-enjoy" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Enjoy Athens</div>
              <div class="card-subtitle">Places that match your interests</div>
            </div>
          </div>
        </div>
        <div id="enjoyContent"></div>
      </section>

      <!-- REQUEST -->
      <section class="screen" id="screen-request" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Request</div>
              <div class="card-subtitle">Ask for something not covered yet</div>
            </div>
          </div>
        </div>

        <div class="card" style="padding:12px;">
          <h3 style="font-size:13px; margin-bottom:8px;">New Request</h3>
          <textarea id="requestText" class="input"
                    placeholder="Describe what you need from the city or community..."
                    style="height:90px;"></textarea>
          <button class="btn btn-primary btn-full" style="margin-top:10px;" onclick="submitRequest()">
            Submit Request (demo)
          </button>
          <p class="note" style="margin-top:6px;">
            AI can later route requests to the right municipal service or community group.
          </p>
        </div>
      </section>

      <!-- COMMUNITY -->
      <section class="screen" id="screen-community" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Community</div>
              <div class="card-subtitle">What is happening around your home and current location</div>
            </div>
          </div>
        </div>
        <div id="communityContent"></div>
      </section>

      <!-- MUNICIPAL: PROBLEMS -->
      <section class="screen" id="screen-muniproblems" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">City Problems</div>
              <div class="card-subtitle">Aggregated citizen reports (demo)</div>
            </div>
          </div>
        </div>
        <div id="muniProblemsContent"></div>
      </section>

      <!-- MUNICIPAL: ADMIN TOOLS -->
      <section class="screen" id="screen-admin" style="display:none; padding:14px;">
        <div class="card" style="margin-bottom:10px;">
          <div class="card-header">
            <div>
              <div class="card-title">Administrator Tools</div>
              <div class="card-subtitle">Municipal services control panel (demo)</div>
            </div>
          </div>
        </div>
        <div id="adminToolsContent"></div>
      </section>

      <!-- MAP -->
      <section class="screen" id="screen-map" style="display:none; padding:0; height:100%; position:relative;">
        <div id="mapFilters"
          style="position:absolute; top:10px; left:10px; z-index:9999;
                 background:white; color:#111827; padding:8px 10px;
                 border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.18);
                 font-size:11px;">
          <strong>Layers</strong><br/>
          <label><input type="checkbox" id="toggleTraffic" checked/> Traffic</label><br/>
          <label><input type="checkbox" id="toggleCleaning" checked/> Cleaning</label><br/>
          <label><input type="checkbox" id="toggleEvents" checked/> Events</label><br/>
          <label><input type="checkbox" id="toggleGarbage" checked/> Garbage Trucks</label><br/>
          <label><input type="checkbox" id="toggleVolunteers" checked/> Volunteers</label><br/>
          <label><input type="checkbox" id="toggleReports" checked/> Reports</label><br/>
          <label><input type="checkbox" id="toggleOffers" checked/> Offers</label><br/>
        </div>
        <div id="mapContainer"></div>
      </section>

      <!-- LOGIN -->
      <section class="screen" id="screen-login" style="display:none; padding:20px;">
        <div class="card">
          <h2 style="margin-bottom:10px;">Login</h2>
          <p class="note" style="margin-bottom:12px;">
            ŒïœÄŒØŒªŒµŒæŒµ œÑŒøŒΩ œÑœçœÄŒø œáœÅŒÆœÉœÑŒ∑ Œ≥ŒπŒ± œÑŒø demo.
          </p>
          <button class="btn btn-primary btn-full" onclick="loginAs('visitor')">Visitor</button>
          <button class="btn btn-outline btn-full" style="margin-top:6px;" onclick="loginAs('citizen')">Citizen</button>
          <button class="btn btn-outline btn-full" style="margin-top:6px;" onclick="loginAs('municipal')">Municipal</button>
          <button class="btn btn-outline btn-full" style="margin-top:6px;" onclick="loginAs('volunteer')">Volunteer</button>
        </div>
      </section>
    </main>

    <nav class="bottom-nav">
      <button class="nav-btn active" data-screen="home">
        <span>üè†</span><span>Home</span>
      </button>
      <button class="nav-btn" data-screen="status">
        <span>üìä</span><span>Status</span>
      </button>
      <button class="nav-btn" data-screen="athens">
        <span>üåÜ</span><span>Athens</span>
      </button>
      <button class="nav-btn" data-screen="map">
        <span>üó∫Ô∏è</span><span>Map</span>
      </button>
    </nav>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    /*****************
     * USERS & LOGIN *
     *****************/
    const LOCAL_USERS = {
      visitor: {
        role: "Visitor",
        name: "John Visitor",
        options: [
          "Athens in a Click",
          "Enjoy Athens",
          "Friendly Walk",
          "Report a Problem",
          "Request",
          "Daily Athens"
        ]
      },
      citizen: {
        role: "Citizen",
        name: "Maria Citizen",
        options: [
          "Daily Athens",
          "Community",
          "Report a Problem"
        ]
      },
      municipal: {
        role: "Municipal",
        name: "Nikos Municipal",
        options: [
          "Daily Athens",
          "Administrator Tools",
          "Problems"
        ]
      },
      volunteer: {
        role: "Volunteer",
        name: "Alex Volunteer",
        options: [
          "Daily Athens",
          "Enable Status",
          "Community",
          "Report a Problem"
        ]
      }
    };

    let activeUser = null;
    let volunteerOnline = false;

    function showScreen(name) {
      const screens = [
        "home","status","athens","map","login",
        "friendly","report","aiclick","enjoy",
        "request","community","volstatus",
        "muniproblems","admin"
      ];
      screens.forEach(s => {
        const el = document.getElementById("screen-" + s);
        if (el) el.style.display = (s === name) ? "block" : "none";
      });

      document.querySelectorAll(".nav-btn").forEach(btn => btn.classList.remove("active"));
      const activeBtn = document.querySelector(`.nav-btn[data-screen="${name}"]`);
      if (activeBtn) activeBtn.classList.add("active");

      if (name === "athens") initDailyAthens();
      if (name === "map") setTimeout(initMap, 200);
      if (name === "status") renderStatusPage();
    }

    document.querySelectorAll(".nav-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const target = btn.getAttribute("data-screen");
        showScreen(target);
      });
    });

    document.getElementById("avatarBtn")
      .addEventListener("click", () => showScreen("login"));

    function loginAs(type) {
      activeUser = LOCAL_USERS[type];
      document.getElementById("userInfoBox").style.display = "block";
      document.getElementById("userName").textContent = activeUser.name;
      document.getElementById("userRole").textContent = activeUser.role;
      document.getElementById("dailyAthensCard").style.display = "none";
      renderHomeMenu();
      showScreen("home");
    }

    function renderHomeMenu() {
      const menu = document.getElementById("homeMenu");
      menu.innerHTML = "";
      if (!activeUser) return;

      activeUser.options.forEach(option => {
        const tile = document.createElement("div");
        tile.className = "home-tile";
        tile.style.padding = "14px";
        tile.style.fontSize = "14px";
        tile.style.marginBottom = "10px";
        tile.textContent = option;

        tile.onclick = () => {
          const opt = option.toLowerCase();

          if (opt.includes("daily athens")) {
            showScreen("athens");
            initDailyAthens();
          } else if (opt.includes("friendly walk")) {
            showScreen("friendly");
            initFriendlyWalk();
          } else if (opt.includes("report a problem")) {
            loadProblemTypes();
            showScreen("report");
          } else if (opt.includes("athens in a click")) {
            renderAthensInClick();
            showScreen("aiclick");
          } else if (opt.includes("enjoy athens")) {
            renderEnjoyAthens();
            showScreen("enjoy");
          } else if (opt.includes("request")) {
            showScreen("request");
          } else if (opt.includes("community")) {
            renderCommunity();
            showScreen("community");
          } else if (opt.includes("enable status")) {
            initVolunteerStatus();
            showScreen("volstatus");
          } else if (opt.includes("problems") && activeUser.role === "Municipal") {
            renderMunicipalProblems();
            showScreen("muniproblems");
          } else if (opt.includes("administrator tools") && activeUser.role === "Municipal") {
            renderAdminTools();
            showScreen("admin");
          } else {
            alert(option + " page not implemented yet");
          }
        };

        menu.appendChild(tile);
      });
    }

    /*********************
     * DAILY ATHENS FEED *
     *********************/
    const DAILY_FEED = {
      highlights: [
        {
          title: "Tonight: Open-air cinema in Thisio",
          desc: "Classic film screening with view to the Acropolis.",
          tag: "Culture ¬∑ Visitor",
          roles: ["visitor","volunteer","all"]
        },
        {
          title: "New cleaning schedule in Koukaki",
          desc: "Extra night shifts for cleaner streets.",
          tag: "City ¬∑ Citizen",
          roles: ["citizen","municipal"]
        },
        {
          title: "High-priority report in Exarchia",
          desc: "Damaged street lights reported by residents.",
          tag: "Alert ¬∑ Municipal",
          roles: ["municipal"]
        },
        {
          title: "Guided walk requests near Psyrri",
          desc: "3 visitors looking for Friendly Walk companions.",
          tag: "Visitors ¬∑ Volunteer",
          roles: ["volunteer","citizen"]
        }
      ],
      news: [
        {
          title: "City announces new bike lanes",
          desc: "Three new bike corridors connecting central districts.",
          tag: "Mobility",
          roles: ["visitor","citizen","volunteer","municipal"]
        },
        {
          title: "Noise control campaign in nightlife areas",
          desc: "Municipal inspectors collaborate with residents.",
          tag: "Policy",
          roles: ["citizen","municipal"]
        }
      ],
      culture: [
        {
          title: "EMST free entrance evening",
          desc: "Modern art museum opens doors for all visitors.",
          tag: "Museum",
          roles: ["visitor","citizen","volunteer"]
        },
        {
          title: "Street food festival at Technopolis",
          desc: "Local vendors & live music all weekend.",
          tag: "Food & Music",
          roles: ["visitor","citizen"]
        }
      ],
      city: [
        {
          title: "Road works near Syntagma",
          desc: "Temporary lane closure, minor delays expected.",
          tag: "Works",
          roles: ["citizen","municipal"]
        },
        {
          title: "New recycling points in Pangrati",
          desc: "Smart bins with fill-level sensors.",
          tag: "Environment",
          roles: ["citizen","municipal"]
        }
      ],
      mobility: [
        {
          title: "Metro extended hours this weekend",
          desc: "Extra routes to support night-time events.",
          tag: "Metro",
          roles: ["visitor","citizen"]
        },
        {
          title: "Heavy traffic near Kifissias",
          desc: "Recommended alternative routes via Attiki Odos.",
          tag: "Traffic",
          roles: ["citizen","municipal"]
        }
      ],
      neighborhood: [
        {
          title: "Neighborhood gathering in Neos Kosmos",
          desc: "Community meeting about public space redesign.",
          tag: "Community",
          roles: ["citizen","volunteer"]
        },
        {
          title: "Graffiti cleanup in Petralona",
          desc: "Volunteer action supported by the municipality.",
          tag: "Cleanup",
          roles: ["volunteer","municipal"]
        }
      ]
    };

    let daCurrentCategory = "highlights";
    let daInitialized = false;

    function getCurrentRoleKey() {
      if (!activeUser) return "visitor";
      const role = (activeUser.role || "").toLowerCase();
      if (role.includes("visitor")) return "visitor";
      if (role.includes("citizen")) return "citizen";
      if (role.includes("municipal")) return "municipal";
      if (role.includes("volunteer")) return "volunteer";
      return "visitor";
    }

    function getPersonalizedFeed(category) {
      const roleKey = getCurrentRoleKey();
      const pool = DAILY_FEED[category] || [];
      const filtered = pool.filter(item =>
        item.roles.includes("all") || item.roles.includes(roleKey)
      );
      return filtered.slice(0, 6);
    }

    function renderDailyAthens(category) {
      daCurrentCategory = category;
      const container = document.getElementById("daCards");
      if (!container) return;

      const items = getPersonalizedFeed(category);
      container.innerHTML = "";

      if (!items.length) {
        container.innerHTML = "<p class='note'>No items for this category yet.</p>";
        return;
      }

      items.forEach(item => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title" style="font-size:13px;">${item.title}</div>
            <span class="tag tag-green" style="font-size:10px;">${item.tag}</span>
          </div>
          <p style="font-size:11px; color:var(--text-muted); margin-top:4px;">
            ${item.desc}
          </p>
        `;
        container.appendChild(card);
      });
    }

    function initDailyAthens() {
      if (!daInitialized) {
        const tabs = document.querySelectorAll(".da-tab");
        tabs.forEach(tab => {
          tab.addEventListener("click", () => {
            tabs.forEach(t => t.classList.remove("active"));
            tab.classList.add("active");
            const cat = tab.getAttribute("data-cat");
            renderDailyAthens(cat);
          });
        });

        const aiBtn = document.getElementById("daAIButton");
        if (aiBtn) {
          aiBtn.addEventListener("click", () => {
            const container = document.getElementById("daCards");
            if (!container) return;
            const cards = Array.from(container.children);
            if (cards.length <= 1) return;
            for (let i = cards.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              container.appendChild(cards[j]);
            }
            alert("AI-enhanced ordering applied (demo).");
          });
        }

        daInitialized = true;
      }
      renderDailyAthens(daCurrentCategory);
    }

    /*******************
     * FRIENDLY WALK AI *
     *******************/
    const FRIENDLY_LOCALS = [
      {name:"Anna",  languages:["English","Greek"],   interests:["food","walks","culture"], area:"Plaka",       rating:4.9},
      {name:"Yuki",  languages:["Japanese","English"],interests:["museums","history"],      area:"Syntagma",    rating:4.8},
      {name:"Marco", languages:["Italian","English"], interests:["nightlife","bars"],       area:"Gazi",        rating:4.7},
      {name:"Laura", languages:["Spanish","English"], interests:["photography","tours"],    area:"Monastiraki", rating:4.9},
      {name:"Kostas",languages:["Greek","English"],   interests:["local life","coffee"],    area:"Pangrati",    rating:4.6}
    ];

    function initFriendlyWalk() {
      detectLocationFW();

      document.getElementById("fwMic").onclick = () => {
        alert("üé§ Voice input is simulated for the demo");
        document.getElementById("fwQuery").value = "Museums near me";
        runFriendlyAI();
      };

      document.getElementById("fwQuery").addEventListener("keyup", runFriendlyAI);

      document.getElementById("fwPickMap").onclick = () => {
        alert("Friendly locals have been notified and appear on the map (demo).");
        showScreen("map");
      };
    }

    function detectLocationFW() {
      const loc = document.getElementById("fwLocation");
      if (!navigator.geolocation) {
        loc.innerHTML = "<strong>‚ö† Location unsupported</strong>";
        return;
      }
      navigator.geolocation.getCurrentPosition(
        pos => {
          const lat = pos.coords.latitude;
          let area = "Athens Center";
          if (lat > 37.985) area = "Kolonaki";
          else if (lat > 37.98) area = "Syntagma";
          else area = "Plaka";
          loc.innerHTML = `<strong>üìç You are near: ${area}</strong>`;
        },
        () => {
          loc.innerHTML = "<strong>‚ö† Location unavailable</strong>";
        }
      );
    }

    function runFriendlyAI() {
      const q = document.getElementById("fwQuery").value.toLowerCase();
      const res = document.getElementById("fwResults");
      if (!q.trim()) {
        res.innerHTML = "";
        return;
      }

      let matches = FRIENDLY_LOCALS.filter(p =>
        p.languages.some(l => q.includes(l.toLowerCase())) ||
        p.interests.some(i => q.includes(i.toLowerCase())) ||
        q.includes(p.area.toLowerCase()) ||
        q.length <= 2
      );

      if (matches.length === 0) {
        matches = FRIENDLY_LOCALS.sort(() => 0.5 - Math.random()).slice(0, 2);
      }

      res.innerHTML = "";
      matches.forEach(p => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title">${p.name}</div>
            <span class="tag tag-green">‚≠ê ${p.rating.toFixed(1)}</span>
          </div>
          <p style="font-size:12px; color:var(--text-muted);">
            Area: ${p.area}<br>
            Languages: ${p.languages.join(", ")}<br>
            Interests: ${p.interests.join(", ")}
          </p>
        `;
        res.appendChild(card);
      });
    }

    /****************
     * REPORT LOGIC *
     ****************/
    const REPORT_TYPES = {
      visitor: [
        "Suspicious Activity / Scam",
        "Unsafe Feeling in Area",
        "Lost Item",
        "Noise / Disturbance",
        "General Observation"
      ],
      citizen: [
        "Damaged Road / Pavement",
        "Broken Street Light",
        "Overflowing Garbage Bin",
        "Graffiti / Vandalism",
        "School Infrastructure Issue",
        "Public Building Damage",
        "Parking Violation",
        "Noise Disturbance"
      ],
      municipal: [
        "High-Priority Damage",
        "Request for Maintenance Crew",
        "Report from Citizen",
        "Utilities Infrastructure Issue"
      ],
      volunteer: [
        "Suspicious Activity",
        "Visitor Assistance Needed",
        "Public Space Clean-up Issue",
        "Lost Visitor",
        "General Alert"
      ]
    };

    function loadProblemTypes() {
      const typeSelect = document.getElementById("problemType");
      typeSelect.innerHTML = "<option value=''>Select...</option>";
      if (!activeUser) return;
      const key = activeUser.role.toLowerCase();
      const list = REPORT_TYPES[key] || REPORT_TYPES.visitor;
      list.forEach(t => {
        const opt = document.createElement("option");
        opt.value = t;
        opt.textContent = t;
        typeSelect.appendChild(opt);
      });
    }

    function useMyLocation() {
      if (!navigator.geolocation) {
        alert("Geolocation not supported.");
        return;
      }
      navigator.geolocation.getCurrentPosition(pos => {
        const { latitude, longitude } = pos.coords;
        document.getElementById("reportLocationText").textContent =
          `Using your location: ${latitude.toFixed(5)}, ${longitude.toFixed(5)}`;
      });
    }

    function pickLocationOnMap() {
      alert("Map picking mode enabled (demo). Choose a point on the map.");
      showScreen("map");
      setTimeout(() => {
        if (!map) return;
        map.once("click", e => {
          const { lat, lng } = e.latlng;
          document.getElementById("reportLocationText").textContent =
            `Selected on map: ${lat.toFixed(5)}, ${lng.toFixed(5)}`;
          showScreen("report");
        });
      }, 300);
    }

    function startVoiceInput() {
      if (!('webkitSpeechRecognition' in window)) {
        alert("Voice recognition not supported in this browser.");
        return;
      }
      const rec = new webkitSpeechRecognition();
      rec.lang = "en-US";
      rec.continuous = false;
      rec.interimResults = false;
      rec.onresult = e => {
        document.getElementById("problemDesc").value =
          e.results[0][0].transcript;
      };
      rec.start();
    }

    function aiDetectProblem() {
      const desc = document.getElementById("problemDesc").value;
      if (!desc.trim()) {
        alert("Describe the issue first.");
        return;
      }
      alert("AI detected possible issue category (demo).");
    }

    function submitReport() {
      alert("Report submitted (demo). Thank you!");
    }

    /*****************
     * MAP + OVERLAYS *
     *****************/
    let map, mapInitialized = false;
    let trafficLayer, cleaningLayer, eventsLayer, garbageLayer,
        volunteerLayer, reportsLayer, offersLayer;
    let garbageTruckMarker;
    let garbagePathIndex = 0;
    const garbageRoute = [
      [37.982, 23.725],
      [37.984, 23.727],
      [37.986, 23.729],
      [37.988, 23.731]
    ];

    function initMap() {
      if (mapInitialized) return;
      mapInitialized = true;

      map = L.map("mapContainer").setView([37.9838, 23.7275], 13);
      map.zoomControl.setPosition("bottomright");

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19
      }).addTo(map);

      trafficLayer   = L.layerGroup().addTo(map);
      cleaningLayer  = L.layerGroup().addTo(map);
      eventsLayer    = L.layerGroup().addTo(map);
      garbageLayer   = L.layerGroup().addTo(map);
      volunteerLayer = L.layerGroup().addTo(map);
      reportsLayer   = L.layerGroup().addTo(map);
      offersLayer    = L.layerGroup().addTo(map);

      updateMapOverlays();
      animateGarbageTruck();

      setInterval(updateMapOverlays, 6000);
      setInterval(animateGarbageTruck, 1500);

      [
        "toggleTraffic","toggleCleaning","toggleEvents","toggleGarbage",
        "toggleVolunteers","toggleReports","toggleOffers"
      ].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.addEventListener("change", updateMapOverlays);
      });
    }

    function updateMapOverlays() {
      if (!mapInitialized) return;

      trafficLayer.clearLayers();
      cleaningLayer.clearLayers();
      eventsLayer.clearLayers();
      volunteerLayer.clearLayers();
      reportsLayer.clearLayers();
      offersLayer.clearLayers();

      // Traffic
      if (document.getElementById("toggleTraffic").checked) {
        [
          [37.984, 23.728],
          [37.982, 23.725]
        ].forEach(p => {
          L.marker(p, { icon: L.divIcon({ className: "trafficDot" }) })
            .addTo(trafficLayer)
            .bindPopup("Traffic: Slow movement");
        });
      }

      // Cleaning
      if (document.getElementById("toggleCleaning").checked) {
        [
          [37.986, 23.732],
          [37.98, 23.73]
        ].forEach(p => {
          L.marker(p, { icon: L.divIcon({ className: "cleaningDot" }) })
            .addTo(cleaningLayer)
            .bindPopup("Cleaning route active");
        });
      }

      // Events
      if (document.getElementById("toggleEvents").checked) {
        [
          [37.978, 23.724],
          [37.99, 23.735]
        ].forEach(p => {
          L.marker(p, { icon: L.divIcon({ className: "eventDot" }) })
            .addTo(eventsLayer)
            .bindPopup("City Event");
        });
      }

      // Volunteers with name + rating
      if (document.getElementById("toggleVolunteers").checked) {
        [
          { coords:[37.985, 23.729], name:"Anna",   rating:4.9 },
          { coords:[37.987, 23.726], name:"Kostas", rating:4.6 }
        ].forEach(v => {
          L.marker(v.coords, { icon: L.divIcon({ className: "volunteerDot" }) })
            .addTo(volunteerLayer)
            .bindPopup(`${v.name} (‚≠ê ${v.rating.toFixed(1)}) ‚Äì Volunteer`);
        });
      }

      // Reports
      if (document.getElementById("toggleReports").checked) {
        [
          [37.983, 23.731],
          [37.981, 23.728]
        ].forEach(p => {
          L.marker(p, { icon: L.divIcon({ className: "reportDot" }) })
            .addTo(reportsLayer)
            .bindPopup("Citizen report");
        });
      }

      // Offers
      if (document.getElementById("toggleOffers").checked) {
        [
          [37.989, 23.733],
          [37.977, 23.722]
        ].forEach(p => {
          L.marker(p, { icon: L.divIcon({ className: "offerDot" }) })
            .addTo(offersLayer)
            .bindPopup("Local Offer");
        });
      }
    }

    function animateGarbageTruck() {
      if (!mapInitialized) return;
      const toggleGarbage = document.getElementById("toggleGarbage");
      if (!toggleGarbage || !toggleGarbage.checked) {
        garbageLayer.clearLayers();
        garbageTruckMarker = null;
        return;
      }
      if (!garbageTruckMarker) {
        garbageTruckMarker = L.marker(garbageRoute[0], {
          icon: L.divIcon({ className: "garbageDot" })
        }).addTo(garbageLayer);
      }
      garbageTruckMarker.setLatLng(garbageRoute[garbagePathIndex]);
      garbageTruckMarker.bindPopup("Garbage Truck");
      garbagePathIndex = (garbagePathIndex + 1) % garbageRoute.length;
    }

    /****************
     * STATUS PAGE  *
     ****************/
    const STATUS_DATA = {
      visitor: {
        visits: ["Acropolis Museum", "Ancient Agora", "National Garden"],
        interests: ["history", "museums", "photography"],
        pendingReviews: [
          { place: "Acropolis Museum", due: true },
          { place: "Ancient Agora",   due: false }
        ],
        reports: [
          { id: 101, type: "Noise",         status: "pending" },
          { id: 102, type: "Scam Attempt",  status: "in-progress" }
        ]
      },
      citizen: {
        reports: [
          { id: 401, type: "Broken Street Light",     status: "done" },
          { id: 402, type: "School Yard Damage",      status: "pending" },
          { id: 403, type: "Overflowing Trash",       status: "in-progress" }
        ],
        community: [
          "Neighborhood Meeting Tonight",
          "Recycling Program in your district"
        ]
      },
      volunteer: {
        honour: 128,
        tasks: [
          "Assist visitor in Plaka",
          "Support cleanup team in Koukaki"
        ],
        alerts: [
          { type: "Lost Visitor", urgent: true },
          { type: "Help Request", urgent: false }
        ]
      },
      municipal: {
        highPriority: [
          { type: "Street Light Failure",       cluster: 6 },
          { type: "Traffic Light Malfunction",  cluster: 3 }
        ],
        crewRequests: [
          "Team needed at Exarchia",
          "Cleaning crew for Pangrati"
        ]
      }
    };

    function getStatusForUser() {
      if (!activeUser) return [];
      const role = activeUser.role.toLowerCase();
      const data = STATUS_DATA[role] || {};
      const prioritized = [];

      if (role.includes("visitor")) {
        if (data.pendingReviews)
          prioritized.push({ title:"Pending Reviews", data:data.pendingReviews });
        if (data.visits)
          prioritized.push({ title:"Your Visits", data:data.visits });
        if (data.reports)
          prioritized.push({ title:"Your Reports", data:data.reports });
      }

      if (role.includes("citizen")) {
        if (data.reports)
          prioritized.push({ title:"Your Reports", data:data.reports });
        if (data.community)
          prioritized.push({ title:"Community Activity", data:data.community });
      }

      if (role.includes("volunteer")) {
        if (data.alerts)
          prioritized.push({ title:"Urgent Alerts", data:data.alerts });
        if (data.tasks)
          prioritized.push({ title:"Upcoming Tasks", data:data.tasks });
      }

      if (role.includes("municipal")) {
        if (data.highPriority)
          prioritized.push({ title:"High Priority Issues", data:data.highPriority });
        if (data.crewRequests)
          prioritized.push({ title:"Crew Requests", data:data.crewRequests });
      }

      return prioritized;
    }

    function renderStatusBlock(b) {
      if (Array.isArray(b.data)) {
        return b.data.map(item => {
          if (typeof item === "string") return "‚Ä¢ " + item;
          if (item.status) {
            const color =
              item.status === "done" ? "green" :
              item.status === "in-progress" ? "orange" : "red";
            return `<div>üîß <strong>${item.type}</strong>
              <span style="color:${color}; font-weight:bold;"> (${item.status})</span></div>`;
          }
          if (item.cluster)
            return `<div>‚ö† ${item.type} ‚Äî <strong>${item.cluster} reports</strong></div>`;
          if (item.due !== undefined)
            return `<div>‚≠ê Review: ${item.place} ${item.due ? "(pending)" : ""}</div>`;
          if (item.urgent !== undefined)
            return `<div>${item.urgent ? "üö®" : "‚ÑπÔ∏è"} ${item.type}</div>`;
          return JSON.stringify(item);
        }).join("<br>");
      }
      return JSON.stringify(b.data);
    }

    function renderStatusPage() {
      const box = document.getElementById("statusContent");
      box.innerHTML = "";

      if (!activeUser) {
        box.innerHTML = `<p class="note">Login to see your status.</p>`;
        return;
      }

      const role = activeUser.role.toLowerCase();
      const data = STATUS_DATA[role] || {};

      if (role.includes("volunteer") && data.honour !== undefined) {
        const badgeCard = document.createElement("div");
        badgeCard.className = "card";
        badgeCard.style.marginBottom = "10px";
        badgeCard.innerHTML = `
          <div class="card-header">
            <div class="card-title">Honour Status</div>
          </div>
          <div style="padding:6px 4px;">
            <span class="honour-badge">‚≠ê Honour Points: ${data.honour}</span>
          </div>
        `;
        box.appendChild(badgeCard);
      }

      const blocks = getStatusForUser();
      if (!blocks.length) {
        box.innerHTML += "<p>No status updates yet.</p>";
        return;
      }

      blocks.forEach(b => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title">${b.title}</div>
          </div>
          <div style="font-size:13px; padding:8px 4px;">
            ${renderStatusBlock(b)}
          </div>
        `;
        box.appendChild(card);
      });
    }

    /***********************
     * VOLUNTEER STATUS    *
     ***********************/
    function initVolunteerStatus() {
      const sw = document.getElementById("volSwitch");
      const txt = document.getElementById("volStatusText");
      if (!sw || !txt) return;

      sw.checked = volunteerOnline;
      txt.innerHTML = `You are currently <strong>${volunteerOnline ? "online" : "offline"}</strong> as volunteer.`;

      sw.onchange = () => {
        volunteerOnline = sw.checked;
        txt.innerHTML = `You are currently <strong>${volunteerOnline ? "online" : "offline"}</strong> as volunteer.`;
      };
    }

    /***********************
     * ATHENS IN A CLICK   *
     ***********************/
    function renderAthensInClick() {
      const box = document.getElementById("aiclickContent");
      box.innerHTML = "";
      const roleKey = getCurrentRoleKey();

      const baseCards = [];

      if (roleKey === "visitor") {
        baseCards.push(
          {title:"Tickets & Passes", desc:"Museum passes, metro & bus info, city cards."},
          {title:"City Services in English", desc:"Helpdesk, emergency info, useful numbers."},
          {title:"Guided Areas", desc:"Suggested districts for safe, friendly walks."}
        );
      } else if (roleKey === "citizen") {
        baseCards.push(
          {title:"My Municipal Services", desc:"KŒïŒ†, appointments, certificate requests."},
          {title:"School & Education", desc:"Info about local schools and activities."},
          {title:"Neighbourhood Dashboard", desc:"Issues, actions and events near your home."}
        );
      } else if (roleKey === "municipal") {
        baseCards.push(
          {title:"Operations Dashboard", desc:"Overview of reports and field teams."},
          {title:"Communication Center", desc:"Messages from citizens and visitors."},
          {title:"Planned Works", desc:"Schedule and communicate municipal works."}
        );
      } else if (roleKey === "volunteer") {
        baseCards.push(
          {title:"Active Missions", desc:"Visitors to assist, areas to support."},
          {title:"Training & Guidelines", desc:"Best practices for friendly walk volunteers."},
          {title:"Community Channels", desc:"Coordinate with other volunteers and city staff."}
        );
      }

      baseCards.forEach(c => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title">${c.title}</div>
          </div>
          <p style="font-size:12px; color:var(--text-muted);">${c.desc}</p>
        `;
        box.appendChild(card);
      });
    }

    /***********************
     * ENJOY ATHENS        *
     ***********************/
    function renderEnjoyAthens() {
      const box = document.getElementById("enjoyContent");
      box.innerHTML = "";

      const demoPlaces = [
        {
          name: "Rebetiko Corner",
          desc: "Live la√Øk√≥ music in a small authentic venue.",
          tag: "Live Music ¬∑ Night"
        },
        {
          name: "Trattoria Athena",
          desc: "Italian cuisine with Acropolis view.",
          tag: "Italian ¬∑ Dinner"
        },
        {
          name: "Hidden Rooftop Bar",
          desc: "Cocktails with panoramic city views.",
          tag: "Drinks ¬∑ View"
        },
        {
          name: "Local Taverna Plaka",
          desc: "Traditional Greek dishes in a quiet street.",
          tag: "Greek ¬∑ Food"
        }
      ];

      demoPlaces.forEach(p => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title">${p.name}</div>
            <span class="tag tag-green">${p.tag}</span>
          </div>
          <p style="font-size:12px; color:var(--text-muted);">
            ${p.desc}<br>
            <span style="font-size:11px; color:#9ca3af;">(Demo: AI would match this to your interests)</span>
          </p>
        `;
        box.appendChild(card);
      });
    }

    /***********************
     * REQUEST & COMMUNITY *
     ***********************/
    function submitRequest() {
      const txt = document.getElementById("requestText").value.trim();
      if (!txt) {
        alert("Please describe your request.");
        return;
      }
      alert("Request submitted (demo). In real app AI would route it to the right service.");
      document.getElementById("requestText").value = "";
    }

    function renderCommunity() {
      const box = document.getElementById("communityContent");
      box.innerHTML = "";

      const cards = [
        {
          title: "School Maintenance",
          desc: "Scheduled playground renovation at your local school.",
          tag: "Education"
        },
        {
          title: "Park Cleanup",
          desc: "Weekend volunteer action in your nearby park.",
          tag: "Environment"
        },
        {
          title: "Road Works Notification",
          desc: "Planned works on your street tomorrow between 09:00‚Äì14:00.",
          tag: "Works"
        }
      ];

      cards.forEach(c => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title">${c.title}</div>
            <span class="tag tag-green">${c.tag}</span>
          </div>
          <p style="font-size:12px; color:var(--text-muted);">${c.desc}</p>
        `;
        box.appendChild(card);
      });
    }

    /***********************
     * MUNICIPAL PROBLEMS  *
     ***********************/
    function renderMunicipalProblems() {
      const box = document.getElementById("muniProblemsContent");
      box.innerHTML = "";

      const mainIssues = [
        { type: "Overflowing garbage bin", appearances: 320 },
        { type: "Illegal parking on crosswalk", appearances: 185 },
        { type: "Damaged road surface", appearances: 142 },
        { type: "Issues at 8th Primary School", appearances: 96 }
      ];

      const mainCard = document.createElement("div");
      mainCard.className = "card";
      mainCard.style.marginBottom = "10px";

      mainCard.innerHTML = `
        <div class="card-header">
          <div class="card-title">Top reported problems</div>
        </div>
        <div style="font-size:13px; padding:4px 2px;">
          ${mainIssues.map(i => `
            <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
              <span>‚Ä¢ ${i.type}</span>
              <span style="color:#dc2626; font-weight:700;">${i.appearances}</span>
            </div>
          `).join("")}
        </div>
      `;
      box.appendChild(mainCard);

      const newCard = document.createElement("div");
      newCard.className = "card";
      newCard.innerHTML = `
        <div class="card-header">
          <div class="card-title">New reports (last hour)</div>
        </div>
        <div style="font-size:12px; padding:4px 2px;">
          <div>‚Ä¢ Broken street light ‚Äì Neos Kosmos (12)</div>
          <div>‚Ä¢ Noise complaints ‚Äì Gazi (8)</div>
          <div>‚Ä¢ Tree blocking sidewalk ‚Äì Koukaki (5)</div>
        </div>
      `;
      box.appendChild(newCard);
    }

    /***********************
     * ADMINISTRATOR TOOLS *
     ***********************/
    function renderAdminTools() {
      const box = document.getElementById("adminToolsContent");
      box.innerHTML = "";

      const services = [
        { name: "Cleaning crew", desc: "Assign cleaning teams to reported problems." },
        { name: "Technical services", desc: "Street lights, road surface, traffic lights." },
        { name: "School maintenance", desc: "School yards, buildings, safety issues." }
      ];

      services.forEach(s => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.marginBottom = "10px";
        card.innerHTML = `
          <div class="card-header">
            <div class="card-title">${s.name}</div>
          </div>
          <p style="font-size:12px; color:var(--text-muted); margin-bottom:8px;">
            ${s.desc}
          </p>
          <div style="display:flex; gap:8px;">
            <button class="btn btn-primary" style="flex:1;" onclick="alert('Send crew (demo).')">
              Send crew
            </button>
            <button class="btn btn-outline" style="flex:1;" onclick="alert('Report new issue (demo).')">
              Report issue
            </button>
          </div>
        `;
        box.appendChild(card);
      });
    }

    // Initial state
    showScreen("home");
  </script>
</body>
</html>
